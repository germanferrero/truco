HOME

browser->+view: request
alt Si está logueado
    view-->-browser: Redirect(Lobby)
else No está logueado
    view-->-browser: TemplateResponse(index)
end


REGISTRO DE CUENTA

browser->+view: request
view->+auth: create_user()
auth->+User: get
User-->-auth: new_user
auth-->view:new_user
view-->-browser: HttpResponseRedirect(lobby)


INICIAR SESION

browser->+view: request
view->+auth: autenticate
auth->+User: get
User-->-auth: user
auth-->view:user
view-->-browser: HttpResponseRedirect(lobby)



CREAR PARTIDA

browser->+view: request
view->+Partida: crear_partida()
Partida-->-view: partida
view->+Partida: agregar_jugador()
Partida-->- view: jugador
view-->-browser: Redirect(Partida)


UNIRSE A UNA PARTIDA

browser->+view: request
view->+Partida: get
Partida-->-view: partida
view->Partida: agregar_jugador(user)
view-->-browser: Redirect(EnEspera)


INICIAR RONDA

browser->+view: request
view->Partida: crear_ronda()
Partida-->view: ronda
view->Ronda: repartir()
Ronda->+Mazo: get_n_cartas()
Mazo-->-Ronda: cartas
Ronda->Jugador1: asignar_cartas(cartas[0..2])
Ronda->Jugador2: asignar_cartas(cartas[3..5])
view-->-browser: Redirect(Ronda)


CANTAR ENVIDO

browser->+view: request
view->Ronda: crear_canto(envido)
view-->-browser: Redirect(EnEspera)


ACEPTAR ENVIDO

browser->+view: request(QUIERO) 
view->Envido: aceptar()
view->+Envido: get_ganador()
Envido-->-view: ganador, puntaje
view-->-browser: response


RECHAZAR ENVIDO

browser->+view: request(QUIERO) 
view->Envido: aceptar()
Envido->Envido: set_puntos_en_juego()
view->+Envido: get_ganador()
Envido-->-view: ganador, puntaje
view-->-browser: Redirect(EnEspera)


CANTAR TRUCO

browser->+view: request
view->Ronda: crear_canto(truco)
view-->-browser: Redirect(EnEspera)


ACEPTAR TRUCO

browser->+view: request(QUIERO) 
view->Canto: aceptar()
view-->-browser: redirect(EnEspera)


CERRAR SESIÓN

browser->+view: request
view->auth: logout()
view-->-browse: HttpResponseRedirect(lobby)


